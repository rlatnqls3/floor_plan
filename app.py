import streamlit as st
from PIL import Image, ImageDraw

# --- 1. í˜ì´ì§€ ì„¤ì • ---
st.set_page_config(page_title="ì„œìš¸ì¼ëŸ¬ìŠ¤íŠ¸ë ˆì´ì…˜ì½”ë¦¬ì•„ 2025 ê¸¸ì°¾ê¸°", page_icon="ğŸ¨")

# --- 2. ìŠ¤íƒ€ì¼ ì„¤ì • ---
st.markdown("""
    <style>
    .stTextInput > div > div > input { font-size: 1.1rem; }
    .guide-text { font-size: 1.3rem; font-weight: bold; color: #FF4B4B; margin-top: 20px;}
    .sub-text { font-size: 1.0rem; color: #555; }
    .error-text { color: #FF4B4B; font-weight: bold; }
    .stButton>button { width: 100%; border-radius: 5px; height: 3em; background-color: #FF4B4B; color: white; }
    </style>
    """, unsafe_allow_html=True)

# --- 3. ì „ì²´ ë¶€ìŠ¤ ë°ì´í„° (PDF ê¸°ë°˜ ì¶”ì¶œ + ì˜¤íƒ€ ë³´ì •) ---
# [í•„ìˆ˜ ìˆ˜ì •] ì•„ë˜ ì¢Œí‘œ (x, y)ëŠ” ëª¨ë‘ ì„ì‹œ ê°’ì…ë‹ˆë‹¤. ë„ë©´ì„ ë³´ê³  ìœ„ì¹˜ë¥¼ ìˆ˜ì •í•´ì£¼ì„¸ìš”.
# ì˜ˆ: "C-118": (10, 20) -> ë„ë©´ì˜ ê°€ë¡œ 10%, ì„¸ë¡œ 20% ì§€ì 
BOOTH_LOCATIONS = {
    # ================= [ì£¼ìš” ì‹œì„¤] =================
    "ì¶œì…êµ¬ (Entrance)": (50, 95),
    "ì¹´í˜í…Œë¦¬ì•„ (Cafeteria)": (10, 15),
    "í™”ì¥ì‹¤ (Restroom)": (90, 50),
    "ìˆ˜ìœ ì‹¤": (85, 10),
    "ê²½í’ˆìˆ˜ë ¹ì²˜": (45, 90),

    # ================= [ê¸°íšê´€ & ì´ë²¤íŠ¸ì¡´] =================
    "ìºë¦¬ì»¤ì³ ê¸°íšê´€": (20, 15),
    "ë””ì €íŠ¸íŒì—…ì¡´": (15, 40),
    "ì•„íŠ¸ì‘ê°€ ì´ˆëŒ€ì „": (15, 60),
    "ë°€ë¦¬ ì´ë²¤íŠ¸ì¡´": (30, 15),
    "ê¸€ë¡œë²Œ ì•„í‹°ìŠ¤íŠ¸ì¡´": (40, 10),
    "ë¨¸ìŠ¤ ê¸°íšê´€": (50, 10),
    "ì˜¤ëŠ˜ì˜ ì„¸ê³„(ì›í™”ì „)": (60, 10),
    "ë‚˜ì˜ ì¼ëŸ¬ìŠ¤íŠ¸ë ˆì´ì…˜ ì´ì•¼ê¸°": (65, 10),
    "ë„¤ì»·í”„ë ˆì„ ì‚¬ì§„ê´€": (10, 10),
    "ë¼ì´ë¸Œë“œë¡œì‰ (Live Drawing)": (25, 25),

    # ================= [Sì¡´: ëŒ€í•™/ê¸°íš/ì´ˆëŒ€ (êµ¬ 5ì¡´)] =================
    "S-101 ê³„ì›ì˜ˆëŒ€ ìˆœìˆ˜ë¯¸ìˆ ì‘ê°€": (80, 20),
    "S-102 ê³„ì›ì˜ˆëŒ€ ìˆœìˆ˜ë¯¸ìˆ í•™ê³¼": (80, 22),
    "S-104 ì´ë“¤ Yidle": (81, 20),
    "S-106 ë°¸íŠ¸ê¸€ë¼ìŠ¤ (BALTGLAS)": (82, 20),
    "S-107 ë§¤ì„œ ëƒ¥ì´": (82, 22),
    "S-108 KANGZI (ê°•ì§€)": (83, 20),
    "S-109 ë””ì•„íŠ¸82 x Croblue": (83, 22),
    "S-110 LJE": (84, 20),
    "S-114 í™ë¬´ì•„": (84, 22),
    "S-115 ë””ì•„ë”ì›”ë“œ": (85, 20),
    "S-117 ëª¨ë¦¬ Morn": (85, 22),
    "S-125 S-225 ì„œìš¸ì˜ˆìˆ ëŒ€í•™êµ ì‹œê°ë””ìì¸ê³¼": (86, 20),

    # ================= [Aì¡´] =================
    "A-101 í´ë¦½ì•„íŠ¸ì½”ë¦¬ì•„ (Clipartkorea)": (10, 80),
    "A-100 1989 PALETTE": (10, 82),
    "A-104 ë¼ë‹ˆë””ìì¸": (11, 80),
    "A-111 ì†ŒëŸ‰": (11, 82),
    "A-114 ë©”ì´ë§ˆíŠ¸": (12, 80),
    "A-118 ë””ì§€": (12, 82),
    "A-121 í˜ì´í¼": (13, 80),
    "A-124 ìì´ì–¸íŠ¸ì•„ì´ ì•„íŠ¸ìŠ¤íŠœë””ì˜¤": (13, 82),
    "A-128 í™ˆì–´ìŠ¤ HOMEUS": (14, 80),
    "A-130 êµ¿ì›Œí¬": (14, 82),
    "A-132 í•˜í•¨ìŠ¤íŠœë””ì˜¤": (15, 80),

    # ================= [Bì¡´ (OCR 8ë¡œ ì¸ì‹ëœ ê²ƒ ë³´ì •)] =================
    "B-104 ê³ ì–‘ì´ë‹¤ë°©": (20, 80),
    "B-110 ì§€ë‹ˆìš”ë‹ˆ": (20, 82),
    "B-111 TTIPCY": (21, 80),
    "B-112 ìë¯¼í•´": (21, 82),
    "B-115 ì§€ì§€(MONZIZI)": (22, 80),
    "B-120 ë¸”ë£¨ì¸ ": (22, 82),
    "B-124 íˆ¬ìœ ëŸ½ë¯¸": (23, 80),
    "B-126 ì„¤ê¸°ì¼ëŸ¬ìŠ¤íŠ¸": (23, 82),
    "B-131 ë¹ˆì§‘": (24, 80),
    "B-201 Gimm": (25, 80),
    "B-218 ì´ˆëª©ì í™”": (25, 82),
    "B-219 í˜ë…€ë¦¬ë‹ˆ": (26, 80),
    "B-220 ë†ë†ì´": (26, 82),
    "B-221 í•œë¦¼ì‚¬": (27, 80),
    "B-224 í‚¤íŒ…ì œì´": (27, 82),

    # ================= [Cì¡´] =================
    "C-100 ìœ¤ì¡°ìœ ë¼": (30, 30),
    "C-103 ë¹„ëª¨ë¸ ìŠ¤íŠœë””ì˜¤": (30, 32),
    "C-104 ë‹¬ë¹›ê³°": (31, 30),
    "C-110 ë¶“í„°ì¹˜": (31, 32),
    "C-111 MachiK": (32, 30),
    "C-112 MIND FAMILY": (32, 32),
    "C-113 yaoyao": (33, 30),
    "C-115 inkpainting": (33, 32),
    "C-118 Art Work Shop Kyoko (ì¿„ì½”)": (34, 30),
    "C-120 ì‚°ê·¸ë¦¬ë©”": (34, 32),
    "C-125 ê¹€íš¨ì •": (35, 30),
    "C-129 ì¼ëŸ¬ìŠ¤íŠ¸ë ˆì´í„° ì–‘íŒŒ": (35, 32),
    "C-130 ìœ„ì‹œìœ (WISHU)": (36, 30),
    "C-131 ì˜¤ë¬˜": (36, 32),
    "C-200 ë§ë¡œí•˜ê³°ê³°": (37, 30),
    "C-208 6-208": (37, 32),
    "C-211 ê´‘íƒœ": (38, 30),
    "C-214 ê¹€ì´ë„¤": (38, 32),
    "C-218 ê¸°ì˜¨ìŠ¤íŠœë””ì˜¤": (39, 30),
    "C-219 ë¦¬í„°í”„ë¡¤ëŸ¬ë¸Œë“œ": (39, 32),
    "C-220 ì˜´ì¦ˆ": (40, 30),
    "C-231 í”¼í”¼": (40, 32),

    # ================= [Dì¡´] =================
    "D-100 ë§ì•ì´ ë””ìì¸": (50, 40),
    "D-101 ë¯¸ì•¼ì˜¤íƒ€ìš´": (50, 42),
    "D-103 ì œë‹ˆë¹Œë¦¬ì§€": (51, 40),
    "D-107 ë°•ì‚°": (51, 42),
    "D-110 ë¡œìŠ¤íŠ¸ì•¤íŒŒìš´ë“œ": (52, 40),
    "D-115 ìŠ¤íŠœë””ì˜¤ ë‹¤ëŒ": (52, 42),
    "D-118 DONEARTH": (53, 40),
    "D-123 ì˜ë„ë¦¬": (53, 42),
    "D-124 íƒ€ë…¸ì›”ë“œ": (54, 40),
    "D-128 ë°”ì´ê³ ëŒ€": (54, 42),
    "D-130 ê·¸ëŸ¬ëŠ” ì¸": (55, 40),
    "D-201 113": (55, 42),
    "D-213 Straycat tarot": (56, 40),
    "D-214 Sleepybere": (56, 42),
    "D-215 The 3rd Daughter": (57, 40),
    "D-216 namodo (ë‚˜ëª¨ë„)": (57, 42),
    "D-219 ë¨¸ë¦¬": (58, 40),
    "D-224 ëª¨ë„ë¦¬ ìŠ¤íŠœë””ì˜¤": (58, 42),
    "D-232 Draft.apics": (59, 40),

    # ================= [Fì¡´] =================
    "F-101 ì½”ì½”ì˜ ê·¸ë¦¼ê³µê°„": (70, 30),
    "F-102 F-202 ê³ ë™ì„±": (70, 32),
    "F-103 í˜¸ë‘": (71, 30),
    "F-104 ì•„ë¼ë¹…ìŠ¤": (71, 32),
    "F-106 í”„ë Œì¦ˆ": (72, 30),
    "F-107 ë‹´ì¥ì•„ë˜": (72, 32),
    "F-108 ê³ ë¼ë‹ˆ": (73, 30),
    "F-114 ë‹¬ë‹´": (73, 32),
    "F-115 í—ˆë‹¤ë§ˆë¦¬": (74, 30),
    "F-116 ëª¨ëª¨ì´í•˜ìš°ìŠ¤": (74, 32),
    "F-119 ì˜¤ê¸°í™˜": (75, 30),
    "F-120 êµ¬ë¦¬": (75, 32),
    "F-124 ë‹ˆì–´ë°”ì´ë””ì–´": (76, 30),
    "F-128 milky rapstar": (76, 32),
    "F-129 ëª¨ì„œë¦¬ ìŠ¤íŠœë””ì˜¤": (77, 30),
    "F-130 ì½”ìŠ¤ëª¨ ìµìŠ¤í”„ë ˆìŠ¤": (77, 32),
    "F-131 Rosemary Hill": (78, 30),
    "F-201 ì‹±í¬ìœ ìŠ¤íŠœë””ì˜¤": (78, 32),
    "F-203 ë“€ì›": (79, 30),
    "F-204 ë‘ë£¨ë­‰ì´ë‘ë”ì§€": (79, 32),
    "F-207 ë³µìí•˜ìš°ìŠ¤": (80, 30),
    "F-209 ë‹¨ì‹ì›": (80, 32),
    "F-211 ì  ë””ë””": (81, 30),
    "F-212 ì—°ë‘ì‹­": (81, 32),
    "F-213 ìš°ë‹¹íƒ•íƒ•ìŠ¤í† ì–´": (82, 30),
    "F-215 ë„ìˆœìƒí˜„": (82, 32),
    "F-220 ì ë™ì‚¬ë‹ˆ": (83, 30),
    "F-221 ë‹¤ëŒ": (83, 32),
    "F-223 ë‹¤ë¸”ë™": (84, 30),
    "F-224 ì§€ìš° ìŠ¤ë§ˆì¼": (84, 32),
    "F-226 ìŠ¤íŠœë””ì˜¤ í‘œë‹ˆ": (85, 30),
    "F-229 ë£¨ì´ì™€ì½”ì´ëˆ„": (85, 32),
    "F-231 Catist": (86, 30),

    # ================= [Gì¡´ (OCR 6ìœ¼ë¡œ ì¸ì‹ëœ ê²ƒ ë³´ì •)] =================
    "G-100 ì‡¼í‚¹í•‘í¬ë¡œì¦ˆ": (40, 60),
    "G-101 ìœ ìŠ¹": (40, 62),
    "G-111 ë„ì•„ì„¸": (41, 60),
    "G-112 ë™ì‹í’ˆì›": (41, 62),
    "G-114 ìš°ì—°ì² ": (42, 60),
    "G-118 ë°±êµ¬ì„±ìŠ¤íŠœë””ì˜¤": (42, 62),
    "G-120 ë‹›(Knit)": (43, 60),
    "G-121 2-121": (43, 62),
    "G-128 í•˜ì´ë³¼ë£¨ìœ ": (44, 60),
    "G-129 Ideal Idea": (44, 62),
    "G-130 ë ˆë“œì´ì–´ìŠ¤í´ëŸ½": (45, 60),
    "G-200 Thustimesu": (45, 62),
    "G-201 ì½œë¦¬ìŠ¤íŠœë””ì˜¤": (46, 60),
    "G-214 í† ë¼ ê³¼ ì¹œêµ¬ë“¤": (46, 62),
    "G-215 í•˜ìŠˆë°´ë“œ": (47, 60),
    "G-223 ì•™ê³ ë¼ë¡œë¼": (47, 62),
    "G-228 CEE": (48, 60),
    "G-229 dawnitive wave": (48, 62),
    "G-231 ì‚¬ë¦¬ì•ˆë£¨ë‹ˆ": (49, 60),

    # ================= [Hì¡´] =================
    "H-100 ì£¼ìŠ¤": (60, 20),
    "H-101 ì•ˆë…•, ë§ë¡œí•˜ ìŠ¤íŠœë””ì˜¤": (60, 22),
    "H-102 ë¦¬ë…¸í”„ë Œì¦ˆ": (61, 20),
    "H-104 ë²¨ë¡œì´ë£¨": (61, 22),
    "H-107 ì¡°ê°": (62, 20),
    "H-110 ì¸„ë¦¬ì„œë": (62, 22),
    "H-112 ìœ êµê³°": (63, 20),
    "H-119 OHD": (63, 22),
    "H-120 ë°€í¬ë³‘ìŠ¤íŠœë””ì˜¤": (64, 20),
    "H-129 ë‹¤ë¼ë¯¸ë„¤": (64, 22),
    "H-130 ë‹¨ì£¼ìŠ¤í€˜ì–´": (65, 20),
    "H-133 studio som": (65, 22),
    "H-200 ë£¨ë£¨í”¼94": (66, 20),
    "H-201 ì±„ë³´ë¦¬": (66, 22),
    "H-202 ìŠ¤íŠœë””ì˜¤ë‹ˆëª¨": (67, 20),
    "H-203 íŒíƒ€í¬ë ˆ": (67, 22),
    "H-204 ê¹€ë³´ë¯¸": (68, 20),
    "H-208 ìˆ˜í”¼": (68, 22),
    "H-211 ë””ì–´í´ë¦¬": (69, 20),
    "H-212 ì„¸ë¼ë² ì–´": (69, 22),
    "H-216 ì „": (70, 20),
    "H-219 From Gyeol": (70, 22),
    "H-220 ì‚°ë½€": (71, 20),
    "H-223 ê³µì§„ì–´íŠ¸": (71, 22),
    "H-225 ì•„ë“": (72, 20),
    "H-228 ì—°ë©”ì´ë“œ": (72, 22),
    "H-230 íí‹°ì§€íŒŒì‹¤": (73, 20),
    "H-231 í—ˆë‹¤ë§ˆë¦¬": (73, 22),

    # ================= [Jì¡´] =================
    "J-102 ì°¨ë¦¬": (10, 50),
    "J-103 ìŠ¤ëˆ„ì¦ˆí‚¤ì¦ˆ": (10, 52),
    "J-106 Netty Lee": (11, 50),
    "J-112 ì—ì´ë“œë°”ì´ìš©": (11, 52),
    "J-115 ìŠ¤ë””": (12, 50),
    "J-120 ë°”ë‚˜ë°€ëŸ¬ìŠ¤íŠ¸": (12, 52),
    "J-124 EM, C": (13, 50),
    "J-125 ë‹ˆë“œ": (13, 52),
    "J-134 ë²”ìº£ì¸ ": (14, 50),
    "J-200 ë¸”ë™ë¼í„°": (14, 52),
    "J-201 ë”©êµ´": (15, 50),
    "J-202 ì¹´ë¼": (15, 52),
    "J-203 ë©”ì´ë§ˆíŠ¸": (16, 50),
    "J-204 ëšœë””ì–´ë¦¬": (16, 52),
    "J-208 HOXIE (ë¡ì‹œ)": (17, 50),
    "J-215 ì–´ë´¤êµ¬": (17, 52),
    "J-219 ë…ë‹¤í•™ë°©": (18, 50),
    "J-220 ìŠ¤íŠœë””ì˜¤ íë“€": (18, 52),
    "J-223 ë¹„íƒ€í¼í¼": (19, 50),
    "J-226 í•˜ë¦¬ì»¤í”¼": (19, 52),
    "J-229 ì ¤ë¦¬ë¶€ (JeliRivu)": (20, 50),
    "J-231 ê°œêµ¬ë¦¬ë¼ë¯¸": (20, 52),

    # ================= [Kì¡´] =================
    "K-101 ì½”ë¦¬ì•„": (90, 10),
    "K-104 ì˜¤ë•ìŠ¤íŠœë””ì˜¤": (90, 12),
    "K-106 ë¼ìš´ë“œë£¨í”„": (91, 10),
    "K-107 ìœ¨ë¬´ìƒìƒ": (91, 12),
    "K-108 ë¯¸ë‰´": (92, 10),
    "K-121 ì•„ì„êµ¬ë¥´ë¯¸": (92, 12),
    "K-128 ë°©ì¥¬": (93, 10),
    "K-130 ìš°ê±°ì§„": (93, 12),
    "K-201 ë³„íˆì¸ê³µì—¬ ê³µë°©": (94, 10),
    "K-204 ë§ˆëŠ„ì´": (94, 12),
    "K-206 ë§ìˆœë§ˆì¼“": (95, 10),
    "K-207 ìŠ¤íŠœë””ì˜¤ ë¹„ì•„ í¬ë˜í”„íŠ¸": (95, 12),
    "K-208 í¬ë¬¼ë•ìƒì ": (96, 10),
    "K-211 ë¸ŒíŒ¨": (96, 12),
    "K-214 ë¬˜ì¹´ìƒì‹¬": (97, 10),
    "K-220 ë§ˆëƒ¥": (97, 12),
    "K-223 ì˜ê·¸ë¦¬ì¦ˆ": (98, 10),
    "K-225 ë³´ë‹¤ìŠ¤í˜ì´ìŠ¤": (98, 12),
    "K-229 ì•¼ìŒíŒ¬": (99, 10),
    "K-231 ì´íŠ¸ë§¨ ë””ì§€ì—°ë¶": (99, 12),
    "K-235 ê¹€ì¤‘ì´": (99, 14),

    # ================= [Lì¡´] =================
    "L-100 í•˜ë‚˜ë‹˜": (5, 70),
    "L-101 ì‹¬ëƒ¥ì¦ˆ": (5, 72),
    "L-103 ë‹ˆë²„ìŠ¤": (6, 70),
    "L-107 í˜êµë¯¸": (6, 72),
    "L-109 ì½©ë™ì´ë„¤": (7, 70),
    "L-112 ë£¨ëª…ì˜ ê·¸ë¦¼ë“¤": (7, 72),
    "L-113 ë©œíŒ…ì»·": (8, 70),
    "L-120 ë¦¬ì–¼(ì„œì˜ˆë¦°)": (8, 72),
    "L-123 í‘¸ì–´ì˜¤": (9, 70),
    "L-131 ê³ ì„ íƒ€": (9, 72),
    "L-207 ë¯¼íƒ€": (10, 70),
    "L-215 ë‹¤ê·¸ë¦¼": (10, 72),
    "L-220 ëª¨ì²´í† ë¦¬": (11, 70),
    "L-224 í¬ë¦¬ë¯¸ë°€í‚¤": (11, 72),

    # ================= [Mì¡´] =================
    "M-101 ë¬¸í•™ ì„­": (25, 90),
    "M-102 ì•„ì•¼ë„¤": (25, 92),
    "M-103 ë”í‘¸ë¦¬ ë¹Œë¦¬ì§€": (26, 90),
    "M-106 ì½”ì½”ì˜ ê·¸ë¦¼ê³µê°„": (26, 92),
    "M-107 ë„¤": (27, 90),
    "M-110 ì‹œì½”ë¥´ ë™ì‚¬ë¬´ì†Œ": (27, 92),
    "M-115 ì´í™”ì—¬ëŒ€ë³‘ì„¤ë¯¸ë””ì–´ê³ ë“±í•™êµ": (28, 90),
    "M-118 ì˜¤ëšì´ìˆ²": (28, 92),
    "M-120 ë§ë¡œí•˜ê³°ê³°": (29, 90),
    "M-121 ì²˜ë¦¬ë¸”ë¡œ": (29, 92),
    "M-126 ìƒì ": (30, 90),
    "M-128 L-113": (30, 92),
    "M-129 ëª¨ë“ ": (31, 90),
    "M-130 ë¯¸ëª¨": (31, 92),
    "M-131 ëŸ¬ë¸Œí¬ë ˆì„¼íŠ¸": (32, 90),
    "M-201 ì€ nuleun": (32, 92),
    "M-204 ë…¸ë² ì§€ì§€ì—": (33, 90),
    "M-206 ë°ë‹¤í•¨ ê·¸ë¦¼ì¼ê¸°": (33, 92),
    "M-207 êµ¬ëƒ¥ì´": (34, 90),
    "M-211 ì•„ë¥´ë² ": (34, 92),
    "M-212 ìœ¼ë‹ˆì„¸ì‘ì—…ì‹¤": (35, 90),
    "M-214 Bookí•´í”¼í•¸ë””": (35, 92),
    "M-215 nunnu": (36, 90),
    "M-216 ê¾¸ê¾¸ë§Œë“¤ê¸°": (36, 92),
    "M-220 ë¦¬í¬í¬": (37, 90),
    "M-225 ë¯€": (37, 92),
    "M-226 ìœ ì–´íˆ¬ë°ì´": (38, 90),
    "M-228 ì±„ë„": (38, 92),
    "M-229 Gunwoo Frierids": (39, 90),
    "M-230 ì‚¬ë¦¬ì•ˆë£¨ë‹ˆ": (39, 92),

    # ================= [Oì¡´ (OCR 0ìœ¼ë¡œ ì¸ì‹ëœ ê²ƒ ë³´ì •)] =================
    "O-101 í‚¤ìŠ¤í‹±ë¹Œë¦¬ì§€": (85, 80),
    "O-102 zeeky": (85, 82),
    "O-104 ê°ì„±ê³µì‘ì†Œ": (86, 80),
    "O-110 ëšœëª¨ë„¤": (86, 82),
    "O-111 ë™ì‹í’ˆì›": (87, 80),
    "O-112 ê°œë°•í•˜": (87, 82),
    "O-113 KNOTKNOT": (88, 80),
    "O-114 í¬ì¹´í¬ì¹´": (88, 82),
    "O-115 ìµœì—°ì§„": (89, 80),
    "O-120 ê¹€ëª¨ì–‘êµ°": (89, 82),
    "O-121 7AM ëª¨ë“  ìˆœê°„ì„ ì¹ í•˜ë‹¤": (90, 80),
    "O-126 ë£¨ë§ˆ": (90, 82),
    "O-131 ë‹ˆì–´ë°”ì´ë””ì–´": (91, 80),
    "O-200 3ë¶„ìˆ˜ì±„ì´ˆìƒí™”": (91, 82),
    "O-201 ëƒ‰ì´ê³¨ê³¨": (92, 80),
    "O-203 ë…¸ë§ˆ": (92, 82),
    "O-210 ìŠ¤íŠœë””ì˜¤ ìª¼ë¬¼": (93, 80),
    "O-211 Bangkok Illustration Fair": (93, 82),
    "O-213 ë‹¨ë¹„ìŠ¤í˜ì´ìŠ¤": (94, 80),
    "O-215 íƒœë¦¼": (94, 82),
    "O-218 í‘¸í‚¤íí‹°": (95, 80),
    "O-220 ë‹¨í’": (95, 82),
    "O-221 ë„ì‹œì˜¤ë¸Œë“œë¦¼": (96, 80),
    "O-223 ìœ„í‹°í”„ë¼í‹°": (96, 82),
    "O-224 ë‹¤ë¼ìŠ¤íŠœë””ì˜¤": (97, 80),
    "O-225 ì°¨": (97, 82),
    "O-226 ëª¨ë˜ë³´ì´": (98, 80),
    "O-228 ì „ì…‹": (98, 82),
    "O-229 ë„¤ëª¨ì§„": (99, 80),
    "O-230 ìš”ìš”": (99, 82),
    "O-231 ì˜¬ë¦¬": (99, 84),

    # ================= [Pì¡´] =================
    "P-100 ì•¼ìš¸ì´ë¯¸ë‹¹": (60, 5),
    "P-101 ë””ì— í”¼ ë¶ìŠ¤í† ì–´": (61, 5),
    "P-103 ë§ˆíŠ¸": (62, 5),
    "P-108 ì§€ì—°": (63, 5),
    "P-111 ë°€í¬ë³‘ìŠ¤íŠœë””ì˜¤": (64, 5),
    "P-113 ì†Œë…€ ìœ ë‹ˆë²„ìŠ¤": (65, 5),
    "P-114 ë¦¬ë™ë„¤ì¹œêµ¬ë“¤": (66, 5),
    "P-115 CEE": (67, 5),
    "P-116 ì˜¤ë¶ˆ": (68, 5),
    "P-117 ë§ˆì˜¤ì•ˆ(ADAN)": (69, 5),
    "P-118 ì¦ˆ(ploppyz)": (70, 5),

    # ================= [Tì¡´] =================
    "T-001 í†¤ì–´ìŠ¤ (TOONUS)": (20, 80),
    "T-204 íˆ¬ìœ ëŸ½ë¯¸": (21, 80),

    # ================= [ë””ì €íŠ¸ ì¡´] =================
    "Dessert-01 ì¿ í‚¤ëŠ” ì—­ì‹œ ì•„ë¦¬ê°ì„±": (5, 40),
    "Dessert-02 ë¹„ë‹¨ìˆ˜ì ": (5, 42),
    "Dessert-03 í”Œë¼ì‰ë”ì¹˜": (6, 40),
    "Dessert-04 ë©”íƒˆíŠ¸": (6, 42),
    "Dessert-05 ë”ë¦¬ì–¼í‹°": (7, 40),
    "Dessert-06 ì¥¬ë‹ˆì¿ í‚¤": (7, 42),
    "Dessert-07 íŒŒíŒŒëˆ„ë£½ì§€": (8, 40),
    "Dessert-08 ë¶ˆëŸ‰": (8, 42),
    "Dessert-09 í”„ë¦¬ë¯¸ì—„ ë§ˆì¹´ë¡± ì¿ í‚¤": (9, 40),
    "Dessert-10 ê¼¬ë§ˆë£¨ìœ¡í¬": (9, 42),
    "Dessert-11 ë‰´ìš•ì˜ ì €ìŠ¤íŠ¸ ì¿ í‚¤": (10, 40),
    "Dessert-12 ìˆœë‘ë¶€ì ¤ë¼ë˜": (10, 42),
    "Dessert-13 ê³¼ë°€ê³¼ì¦™ì ¤ë¦¬": (11, 40),
    "Dessert-14 ë©”íƒ€í”„ë ˆì‰¬": (11, 42),
    "Dessert-15 ë¹„ë‹¨ìˆ˜ì ": (12, 40),
    "Dessert-16 ì–¸ì œë‚˜ ì—¬ë¦„": (12, 42),
    "Dessert-17 ë‹¬ì¹˜ë‚˜": (13, 40),
    "Dessert-18 ì–‘í¬ë„¤": (13, 42),
}

# --- 4. ê²€ìƒ‰ ë¡œì§ (ìŠ¤ë§ˆíŠ¸ ë§¤ì¹­) ---
def find_best_matches(user_input, db_keys):
    if not user_input:
        return []
    
    user_input = user_input.lower().strip()
    matches = []
    
    # ì…ë ¥ ì²˜ë¦¬ (5 -> s, 0 -> o ìë™ ë³´ì •)
    input_nospace = user_input.replace("-", "").replace(" ", "")
    input_corrected_s = input_nospace.replace("5", "s")
    input_corrected_o = input_nospace.replace("0", "o")
    
    for key in db_keys:
        key_lower = key.lower()
        key_nospace = key_lower.replace("-", "").replace(" ", "")
        
        # ë§¤ì¹­ ì¡°ê±´: ì¼ë°˜ í¬í•¨, í•˜ì´í”ˆ ì œê±° ì¼ì¹˜, ìˆ«ì ë³´ì • ì¼ì¹˜
        if (user_input in key_lower) or \
           (input_nospace in key_nospace) or \
           (input_corrected_s in key_nospace and "s" in key_nospace) or \
           (input_corrected_o in key_nospace and "o" in key_nospace):
            matches.append(key)
            
    matches.sort(key=len)
    return matches

# --- 5. ì§€ë„ ê·¸ë¦¬ê¸° ë¡œì§ ---
def draw_manhattan_path(image, start_name, end_name):
    img_copy = image.copy()
    draw = ImageDraw.Draw(img_copy)
    width, height = img_copy.size

    start_pos = BOOTH_LOCATIONS[start_name]
    end_pos = BOOTH_LOCATIONS[end_name]

    sx, sy = start_pos[0] * width / 100, start_pos[1] * height / 100
    ex, ey = end_pos[0] * width / 100, end_pos[1] * height / 100

    # ê²½ë¡œ ê·¸ë¦¬ê¸° (í•«í•‘í¬ ìƒ‰ìƒ)
    draw.line([(sx, sy), (ex, sy), (ex, ey)], fill="#FF007F", width=10)

    # ë§ˆì»¤ ê·¸ë¦¬ê¸°
    r = 15
    # ì¶œë°œ (ì´ˆë¡)
    draw.ellipse((sx-r, sy-r, sx+r, sy+r), fill="#00C853", outline="white", width=3)
    # ë„ì°© (ë¹¨ê°•)
    draw.ellipse((ex-r, ey-r, ex+r, ey+r), fill="#FF0000", outline="white", width=4)
    
    return img_copy

# --- 6. UI êµ¬í˜„ ---
st.title("ğŸ¨ ì„œìš¸ì¼ëŸ¬ìŠ¤íŠ¸ë ˆì´ì…˜ì½”ë¦¬ì•„ 2025")
st.markdown("##### ğŸ“ ë¶€ìŠ¤ë²ˆí˜¸, ì‘ê°€ëª…, ì—…ì²´ëª…ìœ¼ë¡œ ê¸¸ì„ ì°¾ì•„ë³´ì„¸ìš”!")

with st.form("nav_form"):
    col1, col2 = st.columns(2)
    with col1:
        start_input = st.text_input("ì¶œë°œì§€", placeholder="ì˜ˆ: ì…êµ¬, S-101")
    with col2:
        end_input = st.text_input("ëª©ì ì§€", placeholder="ì˜ˆ: ì ¤ë¦¬ë¶€, O-101")
    submit = st.form_submit_button("ê¸¸ì°¾ê¸° ğŸš€")

if submit:
    s_matches = find_best_matches(start_input, BOOTH_LOCATIONS.keys())
    e_matches = find_best_matches(end_input, BOOTH_LOCATIONS.keys())

    if not start_input or not end_input:
        st.warning("ì¶œë°œì§€ì™€ ëª©ì ì§€ë¥¼ ëª¨ë‘ ì…ë ¥í•´ì£¼ì„¸ìš”.")
    elif not s_matches:
        st.error(f"âŒ '{start_input}'ì„(ë¥¼) ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.")
    elif not e_matches:
        st.error(f"âŒ '{end_input}'ì„(ë¥¼) ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.")
    else:
        start_pt, end_pt = s_matches[0], e_matches[0]
        
        st.info(f"ğŸš© ê²½ë¡œ ì•ˆë‚´: **{start_pt}** â¡ **{end_pt}**")
        
        try:
            image = Image.open("sik_floor_plan.jpg")
            result_img = draw_manhattan_path(image, start_pt, end_pt)
            st.image(result_img, use_container_width=True)
        except FileNotFoundError:
            st.error("âš ï¸ 'sik_floor_plan.jpg' íŒŒì¼ì´ ì—†ìŠµë‹ˆë‹¤. GitHubì— ì—…ë¡œë“œí•´ì£¼ì„¸ìš”.")
